<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"/>
  <title>Popular Atacarejo - Trabalhe Conosco</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ======= VARIÁVEIS CORPORATIVAS ======= */
    :root {
      /* Cores Principais - Verde e Preto */
      --primary: #006433;        /* Verde Escuro Corporativo */
      --primary-dark: #004d28;   /* Verde Mais Escuro para Hover */
      --primary-light: #4CAF50;  /* Verde Acento */
      --secondary: #1A1A1A;      /* Preto Suave */
      --text-main: #111111;      /* Texto Quase Preto */
      --text-muted: #666666;     /* Cinza Escuro */
      
      /* Cores de Fundo */
      --bg-body: #F4F6F8;        /* Cinza muito claro (Off-white) */
      --bg-card: #FFFFFF;        /* Branco Puro */
      --bg-input: #FFFFFF;
      
      /* Bordas e Sombras (Cores Neutras) */
      --border-color: #D1D5DB;   /* Cinza Médio */
      --border-focus: #006433;   /* Verde ao focar */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      
      /* Estados */
      --success: #15803d;
      --error: #b91c1c;
      --warning: #b45309;
      
      /* Design System (Mais sóbrio) */
      --radius-sm: 4px;
      --radius-md: 8px;  /* Arredondamento corporativo padrão */
      --radius-lg: 12px;
      
      --transition: all 0.2s ease-in-out;
    }
    
    /* Tema Escuro (Opcional, mas ajustado para Verde/Preto) */
    [data-theme='dark'] {
      --bg-body: #121212;
      --bg-card: #1E1E1E;
      --bg-input: #2C2C2C;
      --text-main: #F3F4F6;
      --text-muted: #9CA3AF;
      --border-color: #374151;
      --secondary: #000000;
    }

    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }
    
    .hidden {
      display: none !important;
    }
    
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: var(--bg-body);
      color: var(--text-main);
      line-height: 1.5;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    .app-container {
      max-width: 1000px; /* Largura controlada para leitura */
      margin: 0 auto;
      padding: 40px 20px;
      flex: 1;
    }
    
    /* ======= HEADER CORPORATIVO ======= */
    .header {
      text-align: center;
      margin-bottom: 50px;
      padding-bottom: 30px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .header-logo {
      width: 80px;
      height: 80px;
      background: var(--primary);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      color: white;
      font-size: 2rem;
      box-shadow: var(--shadow-md);
    }
    
    .header h1 {
      font-family: 'Roboto', sans-serif;
      font-weight: 900;
      font-size: 2.2rem;
      color: var(--secondary);
      margin-bottom: 15px;
      letter-spacing: -0.5px;
      text-transform: uppercase;
    }
    
    .header-subtitle {
      font-size: 1.1rem;
      color: var(--text-muted);
      max-width: 700px;
      margin: 0 auto;
      font-weight: 400;
    }
    
    /* ======= BOTÃO TEMA (Discreto) ======= */
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      width: 40px;
      height: 40px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-main);
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-sm);
      z-index: 1000;
    }
    
    .theme-toggle:hover {
      border-color: var(--primary);
      color: var(--primary);
    }
    
    /* ======= FORM CONTAINER ======= */
    .form-container {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: 40px;
      box-shadow: var(--shadow-lg);
    }
    
    /* ======= STEPPER (Progresso) ======= */
    .stepper {
      display: flex;
      justify-content: space-between;
      margin-bottom: 40px;
      position: relative;
    }
    
    /* Linha de fundo cinza */
    .stepper::before {
      content: '';
      position: absolute;
      top: 20px; /* Metade da altura do step-circle */
      left: 0;
      width: 100%;
      height: 2px;
      background: #E5E7EB;
      z-index: 0;
    }
    
    .step {
      position: relative;
      z-index: 1;
      text-align: center;
      flex: 1;
    }
    
    .step-circle {
      width: 40px;
      height: 40px;
      background: var(--bg-card);
      border: 2px solid #D1D5DB;
      color: var(--text-muted);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 10px;
      font-weight: 700;
      font-size: 1rem;
      transition: var(--transition);
    }
    
    .step-label {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
    }
    
    /* Estados do Stepper */
    .step.active .step-circle {
      border-color: var(--primary);
      background: var(--primary);
      color: white;
      box-shadow: 0 0 0 4px rgba(0, 100, 51, 0.1);
    }
    
    .step.active .step-label {
      color: var(--primary);
    }
    
    .step.done .step-circle {
      border-color: var(--primary);
      background: var(--bg-card);
      color: var(--primary);
    }
    
    .step.done .step-label {
      color: var(--primary);
    }

    /* ======= FIELDSETS ======= */
    fieldset {
      border: none;
      margin-bottom: 40px;
      padding: 0;
    }
    
    fieldset[aria-disabled="true"] {
      opacity: 0.5;
      pointer-events: none;
      filter: grayscale(1);
    }
    
    legend {
      font-family: 'Roboto', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--secondary);
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--primary);
      width: 100%;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .legend-icon {
      color: white;
      background: var(--secondary);
      width: 40px;
      height: 40px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }
    
    /* ======= FORM GRID ======= */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
    }
    
    .form-group label {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--secondary);
      margin-bottom: 8px;
    }
    
    .required::after {
      content: '*';
      color: var(--error);
      margin-left: 4px;
    }
    
    /* ======= INPUTS ======= */
    .input-wrapper {
      position: relative;
    }
    
    .input-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-muted);
      font-size: 1rem;
      pointer-events: none;
    }
    
    input[type="text"],
    input[type="email"],
    input[type="date"],
    select {
      width: 100%;
      padding: 12px 16px 12px 40px; /* Espaço para o ícone */
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      background: var(--bg-input);
      color: var(--text-main);
      font-size: 1rem;
      font-family: inherit;
      transition: var(--transition);
      outline: none;
    }
    
    input:focus,
    select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(0, 100, 51, 0.1);
    }
    
    input[readonly] {
      background-color: #F3F4F6;
      color: var(--text-muted);
      cursor: not-allowed;
      border-style: dashed;
    }
    
    /* SELECT PERSONALIZADO */
    select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23666666'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      background-size: 16px;
      padding-right: 40px;
    }

    /* ======= EXPERIÊNCIAS ======= */
    .experience-question {
      grid-column: 1 / -1;
      margin-bottom: 30px;
      padding: 20px;
      background: #F9FAFB;
      border-left: 4px solid var(--primary);
      border-radius: var(--radius-sm);
    }
    
    .radio-group {
      display: flex;
      gap: 20px;
      margin-top: 10px;
    }

    .radio-option {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      cursor: pointer;
    }
    
    .experience-section {
      margin-bottom: 30px;
      padding: 20px;
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      background: var(--bg-card);
    }

    .experience-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid #E5E7EB;
    }

    .experience-add-btn,
    .remove-experience-btn {
      border: none;
      border-radius: var(--radius-sm);
      font-weight: 600;
      padding: 10px 20px;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
    }

    .experience-add-btn {
      background: var(--secondary);
      color: white;
    }

    .experience-add-btn:hover:not(:disabled) {
      background: var(--primary);
    }

    .remove-experience-btn {
      background: #FEF2F2;
      color: var(--error);
      border: 1px solid #FECACA;
    }
    
    .remove-experience-btn:hover {
      background: #FEE2E2;
    }

    .experience-card {
      background: white;
      border: 1px solid var(--border-color);
      padding: 20px;
      border-radius: var(--radius-md);
      margin-bottom: 15px;
    }
    
    .experience-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .experience-number {
      font-weight: 700;
      color: var(--secondary);
      text-transform: uppercase;
      font-size: 0.8rem;
      letter-spacing: 1px;
    }

    /* ======= HELP TEXT ======= */
    .help-text {
      display: block;
      margin-top: 6px;
      font-size: 0.8rem;
      color: var(--text-muted);
    }
    
    .help-text.success { color: var(--success); font-weight: 500; }
    .help-text.error { color: var(--error); font-weight: 500; }

    /* ======= BOTÃO SUBMIT ======= */
    .submit-section {
      margin-top: 40px;
      padding-top: 30px;
      border-top: 2px solid #E5E7EB;
      text-align: right;
    }
    
    .submit-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 16px 40px;
      border-radius: var(--radius-sm);
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      width: 100%;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: 0 4px 6px -1px rgba(0, 100, 51, 0.4);
    }
    
    .submit-btn:hover:not(:disabled) {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 6px 10px -1px rgba(0, 100, 51, 0.5);
    }
    
    .submit-btn:disabled {
      background: #9CA3AF;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }
    
    .spinner {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255,255,255,0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    /* ======= MENSAGENS ======= */
    .message {
      margin-top: 20px;
      padding: 16px;
      border-radius: var(--radius-sm);
      font-weight: 500;
      display: none;
      text-align: left;
      border-left: 4px solid;
      font-size: 1rem;
    }
    
    .message.success {
      background: #F0FDF4;
      color: var(--success);
      border-left-color: var(--success);
    }
    
    .message.error {
      background: #FEF2F2;
      color: var(--error);
      border-left-color: var(--error);
    }

    /* ======= FOOTER ======= */
    .footer {
      text-align: center;
      padding: 30px 0;
      color: var(--text-muted);
      font-size: 0.9rem;
      margin-top: auto;
      border-top: 1px solid var(--border-color);
    }
    
    .footer-logo {
      font-family: 'Roboto', sans-serif;
      font-weight: 900;
      font-size: 1.5rem;
      color: var(--secondary);
      margin-bottom: 10px;
      text-transform: uppercase;
    }
    
    .footer-logo span {
      color: var(--primary);
    }

    /* ======= ESTILOS DE VALIDAÇÃO VISUAL ======= */
    .input-valid {
      border-color: var(--success) !important;
      background-color: #F0FDF4 !important;
    }
    
    .input-invalid {
      border-color: var(--error) !important;
      background-color: #FEF2F2 !important;
    }
    
    .cpf-validation-indicator {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      opacity: 0;
      transition: var(--transition);
    }
    
    .cpf-validation-indicator.valid {
      background-color: var(--success);
      color: white;
      opacity: 1;
    }
    
    .cpf-validation-indicator.invalid {
      background-color: var(--error);
      color: white;
      opacity: 1;
    }
    
    .cpf-validation-indicator.loading {
      border: 2px solid var(--border-color);
      border-top-color: var(--primary);
      width: 20px;
      height: 20px;
      animation: spin 0.8s linear infinite;
      opacity: 1;
      background: transparent;
    }
    
    /* FILE INPUT */
    input[type="file"] {
      padding: 10px;
    }
    
    input[type="file"]::file-selector-button {
      background: var(--secondary);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: var(--radius-sm);
      font-weight: 600;
      cursor: pointer;
      margin-right: 15px;
      font-size: 0.9rem;
    }
    
    input[type="file"]::file-selector-button:hover {
      background: #000;
    }

    /* ======= TOOLTIP ====== */
    .tooltip {
      position: relative;
      display: inline-block;
      margin-left: 5px;
      color: var(--primary);
      cursor: help;
    }
    
    /* ======= ANIMAÇÕES ======= */
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    @media (max-width: 768px) {
      .app-container { padding: 20px 15px; }
      .header h1 { font-size: 1.8rem; }
      .form-container { padding: 25px; }
      
      .stepper { flex-direction: column; align-items: flex-start; gap: 20px; }
      .stepper::before { display: none; }
      
      .step { display: flex; align-items: center; width: 100%; gap: 15px; }
      .step-circle { margin: 0; }
      .step-label { text-align: left; }
      
      .form-grid { grid-template-columns: 1fr; }
      
      .submit-btn { width: 100%; }
    }
  </style>
</head>
<body data-theme="light">
  <div class="app-container">
    <!-- Botão de Tema -->
    <button class="theme-toggle" id="themeToggle" aria-label="Alternar tema">
      <i class="fas fa-moon"></i>
    </button>
    
    <!-- Header -->
    <header class="header">
      <div class="header-logo">
        <i class="fas fa-briefcase"></i>
      </div>
      <h1>Popular Atacarejo</h1>
      <p class="header-subtitle">Junte-se à nossa equipe. Preencha o formulário abaixo para se candidatar a uma vaga.</p>
    </header>
    
    <!-- Form Container -->
    <div class="form-container">
      <form id="formCurriculo" novalidate>
        <!-- Stepper -->
        <div class="stepper" role="tablist" aria-label="Progresso do formulário">
          <div class="step" id="step1Head" role="tab" aria-selected="true">
            <div class="step-circle">1</div>
            <span class="step-label">Dados Pessoais</span>
          </div>
          <div class="step" id="step2Head" role="tab" aria-selected="false">
            <div class="step-circle">2</div>
            <span class="step-label">Endereço</span>
          </div>
          <div class="step" id="step3Head" role="tab" aria-selected="false">
            <div class="step-circle">3</div>
            <span class="step-label">Candidatura</span>
          </div>
        </div>
        
        <!-- ETAPA 1: Dados Pessoais -->
        <fieldset id="fs1" aria-labelledby="step1Head">
          <legend>
            <div class="legend-icon">
              <i class="fas fa-user"></i>
            </div>
            <span>Informações Pessoais</span>
          </legend>
          <div class="form-grid">
            <div class="form-group">
              <label for="nome" class="required">Nome Completo</label>
              <div class="input-wrapper">
                <i class="fas fa-user input-icon"></i>
                <input type="text" id="nome" name="nome" required placeholder="Seu nome completo" aria-describedby="nome-help">
              </div>
              <span class="help-text" id="nome-help">Digite seu nome completo como no documento</span>
            </div>
            
            <div class="form-group">
              <label for="cpf" class="required">CPF</label>
              <div class="input-wrapper">
                <i class="fas fa-id-card input-icon"></i>
                <input type="text" id="cpf" name="cpf" required placeholder="000.000.000-00" aria-describedby="cpf-help">
                <span class="cpf-validation-indicator" id="cpfValidationIndicator"></span>
              </div>
              <span class="help-text" id="cpf-help">Digite apenas números</span>
            </div>
            
            <div class="form-group">
              <label for="telefone" class="required">Telefone</label>
              <div class="input-wrapper">
                <i class="fas fa-phone input-icon"></i>
                <input type="text" id="telefone" name="telefone" required placeholder="(00) 00000-0000" aria-describedby="telefone-help">
              </div>
              <span class="help-text" id="telefone-help">Celular com WhatsApp</span>
            </div>
            
            <div class="form-group">
              <label for="email" class="required">E-mail</label>
              <div class="input-wrapper">
                <i class="fas fa-envelope input-icon"></i>
                <input type="email" id="email" name="email" required placeholder="seuemail@exemplo.com" aria-describedby="email-help">
              </div>
              <span class="help-text" id="email-help">Enviaremos confirmação para este e-mail</span>
            </div>
          </div>
        </fieldset>
        
        <!-- ETAPA 2: Endereço -->
        <fieldset id="fs2" aria-labelledby="step2Head" aria-disabled="true" disabled>
          <legend>
            <div class="legend-icon">
              <i class="fas fa-home"></i>
            </div>
            <span>Endereço</span>
          </legend>
          <div class="form-grid">
            <div class="form-group">
              <label for="cep" class="required">CEP</label>
              <div class="input-wrapper">
                <i class="fas fa-map-marker-alt input-icon"></i>
                <input type="text" id="cep" name="cep" required placeholder="00000-000" aria-describedby="cep-help">
              </div>
              <span class="help-text" id="cep-help">Digite o CEP para buscar automaticamente</span>
            </div>
            
            <div class="form-group">
              <label for="cidade" class="required">Cidade</label>
              <div class="input-wrapper">
                <i class="fas fa-city input-icon"></i>
                <input type="text" id="cidade" name="cidade" required placeholder="Sua cidade" readonly aria-describedby="cidade-help">
              </div>
              <span class="help-text" id="cidade-help">Preenchido automaticamente</span>
            </div>
            
            <div class="form-group">
              <label for="bairro" class="required">Bairro</label>
              <div class="input-wrapper">
                <i class="fas fa-map input-icon"></i>
                <input type="text" id="bairro" name="bairro" required placeholder="Seu bairro" readonly aria-describedby="bairro-help">
              </div>
              <span class="help-text" id="bairro-help">Preenchido automaticamente</span>
            </div>
            
            <div class="form-group">
              <label for="rua" class="required">Rua</label>
              <div class="input-wrapper">
                <i class="fas fa-road input-icon"></i>
                <input type="text" id="rua" name="rua" required placeholder="Nome da sua rua" readonly aria-describedby="rua-help">
              </div>
              <span class="help-text" id="rua-help">Preenchido automaticamente</span>
            </div>
          </div>
        </fieldset>
        
        <!-- ETAPA 3: Candidatura -->
        <fieldset id="fs3" aria-labelledby="step3Head" aria-disabled="true" disabled>
          <legend>
            <div class="legend-icon">
              <i class="fas fa-briefcase"></i>
            </div>
            <span>Candidatura</span>
          </legend>
          <div class="experience-question">
            <label class="required" style="display:block; margin-bottom: 10px;">Tem experiência profissional?</label>
            <div class="radio-group">
              <label class="radio-option">
                <input type="radio" name="tem_experiencia" value="Sim" required>
                Sim
              </label>
              <label class="radio-option">
                <input type="radio" name="tem_experiencia" value="Não" required>
                Não
              </label>
            </div>
          </div>
          <div id="experiencesSection" class="experience-section hidden">
            <div class="experience-actions">
              <button type="button" id="addExperienceBtn" class="experience-add-btn">
                <i class="fas fa-plus"></i> Adicionar Experiência
              </button>
            </div>
            <div id="experiencesList"></div>
          </div>
          <template id="experienceTemplate">
            <div class="experience-card">
              <div class="experience-card-header">
                <span class="experience-number">Experiência</span>
                <button type="button" class="remove-experience-btn" aria-label="Remover experiência">
                  <i class="fas fa-trash"></i> Remover
                </button>
              </div>
              <div class="form-grid experience-grid">
                <div class="form-group">
                  <label>Empresa</label>
                  <div class="input-wrapper">
                    <i class="fas fa-building input-icon"></i>
                    <input type="text" name="experiencia_empresa[]" placeholder="Nome da empresa">
                  </div>
                </div>
                <div class="form-group">
                  <label>Função</label>
                  <div class="input-wrapper">
                    <i class="fas fa-user-tie input-icon"></i>
                    <input type="text" name="experiencia_cargo[]" placeholder="Cargo ocupado">
                  </div>
                </div>
                <div class="form-group">
                  <label>Data de Admissão</label>
                  <div class="input-wrapper">
                    <i class="fas fa-calendar input-icon"></i>
                    <input type="date" name="experiencia_admissao[]">
                  </div>
                </div>
                <div class="form-group">
                  <label>Data de Desligamento</label>
                  <div class="input-wrapper">
                    <i class="fas fa-calendar input-icon"></i>
                    <input type="date" name="experiencia_demissao[]">
                  </div>
                </div>
              </div>
            </div>
          </template>
          <div class="form-grid">
            <div class="form-group">
              <label for="transporte" class="required">Possui Transporte Próprio?</label>
              <div class="input-wrapper">
                <i class="fas fa-car input-icon"></i>
                <select id="transporte" name="transporte" required aria-describedby="transporte-help">
                  <option value="" disabled selected>Selecione...</option>
                  <option value="Sim">Sim</option>
                  <option value="Não">Não</option>
                </select>
              </div>
            </div>
            
            <div class="form-group">
              <label for="vaga" class="required">Vaga Desejada</label>
              <div class="input-wrapper">
                <i class="fas fa-briefcase input-icon"></i>
                <select id="vaga" name="vaga" required aria-describedby="vaga-help">
                  <option value="" disabled selected>Carregando vagas...</option>
                </select>
              </div>
            </div>
            
            <div class="form-group" style="grid-column: 1 / -1;">
              <label for="arquivo" class="required">Anexar Currículo</label>
              <div class="input-wrapper">
                <input type="file" id="arquivo" name="arquivo" accept=".pdf,.doc,.docx" required aria-describedby="arquivo-help">
              </div>
              <span class="help-text" id="arquivo-help">PDF, DOC ou DOCX. Máx: 5MB.</span>
            </div>
          </div>
        </fieldset>
        
        <!-- Botão de Envio -->
        <div class="submit-section">
          <button type="submit" id="submitButton" class="submit-btn" disabled aria-label="Enviar candidatura">
            <span class="btn-text">Enviar Candidatura</span>
            <span class="spinner hidden"></span>
            <i class="fas fa-paper-plane btn-icon" style="display: none;"></i>
          </button>
        </div>
        
        <!-- Mensagens -->
        <div class="message success hidden" id="mensagemSucesso" role="alert"></div>
        <div class="message error hidden" id="mensagemErro" role="alert"></div>
      </form>
    </div>
    
    <!-- Footer -->
    <footer class="footer">
      <div class="footer-logo">
        <span>Popular</span> Atacarejo
      </div>
      <p>© 2026 Todos os direitos reservados.</p>
      <p style="margin-top: 5px; font-size: 0.8rem; opacity: 0.7;">
        Portal de Recrutamento
      </p>
    </footer>
  </div>

  <script src="https://unpkg.com/imask"></script>
  <script>
    // ====== CONFIGURAÇÕES ======
    const API_BASE = "https://candidatos.onrender.com";
    const FILE_MAX_MB = 5;
    const VAGAS_GITHUB_URL = "https://raw.githubusercontent.com/PopularAtacarejo/Candidatos/main/vagas.json";
    const DEFAULT_VAGAS = [
      { nome: "Auxiliar de Limpeza" }, { nome: "Vendedor" }, { nome: "Caixa" },
      { nome: "Estoquista" }, { nome: "Repositor" }, { nome: "Atendente" },
      { nome: "Gerente" }, { nome: "Supervisor" }, { nome: "Operador de Caixa" }
    ];
    const EXPERIENCE_RADIO_NAME = "tem_experiencia";
    const MAX_EXPERIENCE_ENTRIES = 10;

    // ====== ELEMENTOS DOM ======
    const form = document.getElementById("formCurriculo");
    const themeToggle = document.getElementById("themeToggle");
    const nome = document.getElementById("nome");
    const cpf = document.getElementById("cpf");
    const telefone = document.getElementById("telefone");
    const email = document.getElementById("email");
    const cep = document.getElementById("cep");
    const cidade = document.getElementById("cidade");
    const bairro = document.getElementById("bairro");
    const rua = document.getElementById("rua");
    const transporte = document.getElementById("transporte");
    const vaga = document.getElementById("vaga");
    const arquivo = document.getElementById("arquivo");
    const temExperienciaRadios = document.querySelectorAll(`input[name="${EXPERIENCE_RADIO_NAME}"]`);
    const experiencesSection = document.getElementById("experiencesSection");
    const experiencesList = document.getElementById("experiencesList");
    const addExperienceBtn = document.getElementById("addExperienceBtn");
    const experienceTemplate = document.getElementById("experienceTemplate");
    
    const submitBtn = document.getElementById("submitButton");
    const btnText = submitBtn.querySelector(".btn-text");
    const spinner = submitBtn.querySelector(".spinner");
    const successMsg = document.getElementById("mensagemSucesso");
    const errorMsg = document.getElementById("mensagemErro");
    
    const step1Head = document.getElementById("step1Head");
    const step2Head = document.getElementById("step2Head");
    const step3Head = document.getElementById("step3Head");
    const fs1 = document.getElementById("fs1");
    const fs2 = document.getElementById("fs2");
    const fs3 = document.getElementById("fs3");

    // ====== TEMA ======
    themeToggle.addEventListener("click", () => {
      const currentTheme = document.body.getAttribute("data-theme");
      const newTheme = currentTheme === "light" ? "dark" : "light";
      document.body.setAttribute("data-theme", newTheme);
      const icon = themeToggle.querySelector("i");
      icon.className = newTheme === "dark" ? "fas fa-sun" : "fas fa-moon";
    });

    // ====== MÁSCARAS ======
    const cpfMask = IMask(cpf, { mask: "000.000.000-00", lazy: false });
    const cepMask = IMask(cep, { mask: "00000-000", lazy: false });
    const telefoneMask = IMask(telefone, { mask: [{mask: "(00) 0000-0000"}, {mask: "(00) 00000-0000"}], lazy: false });

    // ====== VALIDAÇÃO DE CPF ======
    const cpfValidationIndicator = document.getElementById('cpfValidationIndicator');
    let cpfValidationTimeout = null;
    let lastValidatedCpfDigits = '';
    let lastCpfValidationResult = null;

    async function validateCPF(cpfValue) {
      const cpfDigits = cpfValue.replace(/\D/g, '');
      if (cpfDigits.length !== 11) {
        cpf.classList.add('input-invalid');
        return false;
      }
      if (cpfDigits === lastValidatedCpfDigits && lastCpfValidationResult !== null) return lastCpfValidationResult;
      if (cpfValidationTimeout) clearTimeout(cpfValidationTimeout);
      
      cpfValidationIndicator.className = 'cpf-validation-indicator loading';
      cpf.classList.remove('input-valid', 'input-invalid');

      return new Promise((resolve) => {
        cpfValidationTimeout = setTimeout(async () => {
          try {
            const response = await fetch(`https://scpa-backend.saude.gov.br/public/scpa-usuario/validacao-cpf/${cpfDigits}`, {
              method: 'GET', headers: { 'Accept': 'application/json' }, cache: 'no-store'
            });
            if (response.ok) {
              const data = await response.json();
              if (data === true) {
                cpfValidationIndicator.className = 'cpf-validation-indicator valid';
                cpf.classList.add('input-valid');
                document.getElementById('cpf-help').textContent = 'CPF Válido';
                document.getElementById('cpf-help').className = 'help-text success';
                lastValidatedCpfDigits = cpfDigits; lastCpfValidationResult = true;
                resolve(true);
              } else {
                throw new Error("CPF Inválido");
              }
            } else {
              throw new Error("Erro na API");
            }
          } catch (error) {
            cpfValidationIndicator.className = 'cpf-validation-indicator';
            cpf.classList.remove('input-valid', 'input-invalid');
            lastValidatedCpfDigits = ''; lastCpfValidationResult = null;
            document.getElementById('cpf-help').textContent = 'Validação indisponível, você pode continuar.';
            document.getElementById('cpf-help').className = 'help-text';
            resolve(true);
          }
        }, 800);
      });
    }

    cpf.addEventListener('blur', async () => { if(cpf.value.trim() !== '') { await validateCPF(cpf.value); updateSteps(); } });

    // ====== VIACEP ======
    let cepTimeout;
    cep.addEventListener("input", () => {
      clearTimeout(cepTimeout);
      const cepValue = cep.value.replace(/\D/g, "");
      if (cepValue.length < 8) { resetAddressFields(); return; }
      
      cepTimeout = setTimeout(async () => {
        if (cepValue.length !== 8) { resetAddressFields(); return; }
        try {
          const response = await fetch(`https://viacep.com.br/ws/${cepValue}/json/`, { cache: "no-store" });
          if (!response.ok) throw new Error("Erro");
          const data = await response.json();
          if (data.erro) {
            resetAddressFields();
          } else {
            cidade.value = data.localidade || "";
            bairro.value = data.bairro || "";
            rua.value = data.logradouro || "";
            cidade.classList.add("input-valid");
            bairro.classList.add("input-valid");
            rua.classList.add("input-valid");
            updateSteps();
          }
        } catch (e) {
          resetAddressFields();
        }
      }, 800);
    });

    function resetAddressFields() {
      cidade.value = ""; bairro.value = ""; rua.value = "";
      cidade.classList.remove("input-valid"); bairro.classList.remove("input-valid"); rua.classList.remove("input-valid");
      updateSteps();
    }

    // ====== CARREGAR VAGAS ======
    async function loadVagasFromGitHub() {
      const selectVaga = document.getElementById('vaga');
      selectVaga.innerHTML = '<option value="" disabled selected>Carregando...</option>';
      selectVaga.disabled = true;
      
      let vagasData = [];
      try {
        const response = await fetch(VAGAS_GITHUB_URL, { cache: "no-store" });
        if (response.ok) vagasData = await response.json();
      } catch (e) { console.error(e); }

      const finalVagas = (vagasData || []).length > 0 ? vagasData : DEFAULT_VAGAS;
      selectVaga.innerHTML = '<option value="" disabled selected>Selecione a vaga...</option>';
      selectVaga.disabled = false;

      finalVagas.forEach(v => {
        const opt = document.createElement('option');
        opt.value = typeof v === 'string' ? v : v.nome;
        opt.textContent = typeof v === 'string' ? v : v.nome;
        selectVaga.appendChild(opt);
      });
      updateSteps();
    }

    // ====== UTILITÁRIOS ======
    function showMessage(el, msg) { el.textContent = msg; el.classList.remove("hidden"); el.style.display = "block"; }
    function hideMessages() { [successMsg, errorMsg].forEach(m => { m.classList.add("hidden"); m.style.display = "none"; }); }
    function showError(msg) { showMessage(errorMsg, msg); }
    function showSuccess(msg) { showMessage(successMsg, msg); }
    function setLoading(isLoading) {
      if (isLoading) {
        btnText.classList.add("hidden"); spinner.classList.remove("hidden"); submitBtn.disabled = true;
      } else {
        btnText.classList.remove("hidden"); spinner.classList.add("hidden"); if(!submitBtn.disabled) submitBtn.disabled = false;
      }
    }
    function validateFile() {
      const f = arquivo.files?.[0];
      if (!f) return false;
      const ext = f.name.toLowerCase().split('.').pop();
      if (f.size > FILE_MAX_MB * 1024 * 1024 || !['pdf','doc','docx'].includes(ext)) return false;
      return true;
    }
    function createFormData() {
      const formData = new FormData();
      formData.append("nome", nome.value.trim());
      formData.append("cpf", cpf.value);
      formData.append("telefone", telefone.value);
      formData.append("email", email.value.trim().toLowerCase());
      formData.append("cep", cep.value);
      formData.append("cidade", cidade.value);
      formData.append("bairro", bairro.value);
      formData.append("rua", rua.value);
      formData.append("transporte", transporte.value);
      formData.append("vaga", vaga.value);
      formData.append("arquivo", arquivo.files[0]);
      
      const selectedExp = document.querySelector(`input[name="${EXPERIENCE_RADIO_NAME}"]:checked`)?.value || "";
      formData.append("tem_experiencia", selectedExp);

      if (selectedExp === "Sim" && experiencesList) {
        const experiences = [];
        experiencesList.querySelectorAll(".experience-card").forEach((card) => {
          const c = card.querySelector('input[name="experiencia_empresa[]"]');
          const r = card.querySelector('input[name="experiencia_cargo[]"]');
          const a = card.querySelector('input[name="experiencia_admissao[]"]');
          const d = card.querySelector('input[name="experiencia_demissao[]"]');
          if (c && r && a && d && c.value.trim() && r.value.trim()) {
            experiences.push({ empresa: c.value.trim(), funcao: r.value.trim(), data_admissao: a.value, data_demissao: d.value });
          }
        });
        if (experiences.length > 0) formData.append("experiencias", JSON.stringify(experiences));
      }
      return formData;
    }
    async function fetchWithTimeout(url, options = {}, timeout = 30000) {
      const controller = new AbortController();
      const id = setTimeout(() => controller.abort(), timeout);
      try { return await fetch(url, { ...options, signal: controller.signal, cache: "no-store" }); } finally { clearTimeout(id); }
    }

    // ====== VALIDAÇÃO POR ETAPA ======
    const step1Fields = [nome, cpf, telefone, email];
    const step2Fields = [cep, cidade, bairro, rua];
    const step3Fields = [transporte, vaga, arquivo];

    function getSelectedExperienceOption() { return document.querySelector(`input[name="${EXPERIENCE_RADIO_NAME}"]:checked`); }
    function areExperiencesValid() {
      const selected = getSelectedExperienceOption();
      if (!selected || selected.value === "Não") return true;
      if (!experiencesList) return false;
      const cards = experiencesList.querySelectorAll(".experience-card");
      if (!cards.length) return false;
      return Array.from(cards).every(c => Array.from(c.querySelectorAll("input")).every(i => i.value.trim().length > 0));
    }
    function updateExperienceHeader() {
      if (!experiencesList) return;
      const cards = experiencesList.querySelectorAll(".experience-card");
      cards.forEach((card, idx) => {
        const n = card.querySelector(".experience-number");
        if (n) n.textContent = `Experiência ${idx + 1}`;
        const b = card.querySelector(".remove-experience-btn");
        if (b) b.style.visibility = cards.length === 1 ? "hidden" : "visible";
      });
      if (addExperienceBtn) addExperienceBtn.disabled = (getSelectedExperienceOption()?.value !== "Sim") || cards.length >= MAX_EXPERIENCE_ENTRIES;
    }
    function addExperienceCard() {
      if (!experienceTemplate || !experiencesList || experiencesList.children.length >= MAX_EXPERIENCE_ENTRIES) return;
      const clone = experienceTemplate.content.cloneNode(true);
      const card = clone.querySelector(".experience-card");
      const removeBtn = card.querySelector(".remove-experience-btn");
      if (removeBtn) {
        removeBtn.addEventListener("click", () => {
          card.remove(); updateExperienceHeader(); updateSteps();
        });
      }
      experiencesList.appendChild(card);
      card.querySelectorAll("input").forEach(i => { i.value = ""; setupFieldValidation(i); });
      updateExperienceHeader(); updateSteps();
    }
    function updateExperienceVisibility() {
      if (!experiencesSection || !addExperienceBtn) return;
      const hasExp = getSelectedExperienceOption()?.value === "Sim";
      if (hasExp) {
        experiencesSection.classList.remove("hidden");
        if (experiencesList.children.length === 0) addExperienceCard();
      } else {
        experiencesSection.classList.add("hidden");
        experiencesList.innerHTML = "";
      }
      addExperienceBtn.disabled = !hasExp || experiencesList.children.length >= MAX_EXPERIENCE_ENTRIES;
      updateExperienceHeader();
    }
    function resetExperiencesSection() {
      temExperienciaRadios.forEach(r => r.checked = false);
      if (experiencesList) experiencesList.innerHTML = "";
      updateExperienceVisibility();
    }
    function isFieldValid(f) {
      if (f.id === 'cpf') {
        if (f.value.trim().length === 0) return false;
        if (f.classList.contains('input-invalid')) return false;
        return f.value.length === 14;
      }
      if (f.type === 'email') return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f.value.trim());
      if (f.tagName === 'SELECT') return !!f.value;
      if (f.type === 'file') return !!f.files?.length;
      return f.value.trim().length > 0;
    }
    function setFieldsetState(fs, enabled) {
      if (enabled) {
        fs.removeAttribute('disabled'); fs.setAttribute('aria-disabled', 'false'); fs.style.opacity = '1'; fs.style.pointerEvents = 'auto';
      } else {
        fs.setAttribute('disabled', ''); fs.setAttribute('aria-disabled', 'true'); fs.style.opacity = '0.5'; fs.style.pointerEvents = 'none';
      }
    }
    function updateSteps() {
      const s1 = step1Fields.every(isFieldValid);
      const s2 = s1 && step2Fields.every(isFieldValid);
      const s3 = s2 && step3Fields.every(isFieldValid) && !!getSelectedExperienceOption() && areExperiencesValid();
      
      setFieldsetState(fs2, s1);
      setFieldsetState(fs3, s2);
      
      step1Head.className = `step ${s1 ? 'done' : 'active'}`;
      step2Head.className = `step ${s2 ? 'done' : (s1 ? 'active' : '')}`;
      step3Head.className = `step ${s3 ? 'done' : (s2 ? 'active' : '')}`;
      
      submitBtn.disabled = !s3;
    }
    function setupFieldValidation(f) {
      const ev = f.type === 'file' ? 'change' : 'input';
      f.addEventListener(ev, function() {
        if (this.value.trim() === '') { this.classList.remove('input-valid', 'input-invalid'); }
        else if (isFieldValid(this)) { this.classList.add('input-valid'); this.classList.remove('input-invalid'); }
        else { this.classList.add('input-invalid'); this.classList.remove('input-valid'); }
        updateSteps();
      });
    }

    [...step1Fields, ...step2Fields, transporte, arquivo].forEach(setupFieldValidation);
    vaga.addEventListener('change', () => { setupFieldValidation(vaga); updateSteps(); });
    temExperienciaRadios.forEach(r => r.addEventListener('change', () => { updateExperienceVisibility(); updateSteps(); }));
    if (addExperienceBtn) addExperienceBtn.addEventListener('click', () => addExperienceCard());

    document.addEventListener('DOMContentLoaded', () => {
      loadVagasFromGitHub();
      updateExperienceVisibility();
      updateSteps();
      nome.focus();
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault(); hideMessages();
      if (!validateFile()) return;
      setLoading(true);
      try {
        const response = await fetchWithTimeout(`${API_BASE}/api/enviar`, { method: "POST", body: createFormData() }, 60000);
        const data = await response.json();
        if (response.ok) {
          showSuccess(data?.message || "Candidatura enviada com sucesso!");
          form.reset(); resetAddressFields(); resetExperiencesSection();
          cpfMask.update(""); cepMask.update(""); telefoneMask.update("");
          updateSteps(); setTimeout(loadVagasFromGitHub, 2000);
        } else {
          showError(data?.detail || "Erro ao enviar.");
        }
      } catch (err) {
        showError("Erro de conexão.");
      } finally {
        setLoading(false);
      }
    });
  </script>
</body>
</html>
